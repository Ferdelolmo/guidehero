{"version":3,"file":"instrumentation.js","sourceRoot":"","sources":["../../../../src/instrumentations/userActions/instrumentation.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,mBAAmB,EAAE,IAAI,EAAqB,qBAAqB,EAAE,OAAO,EAAE,MAAM,oBAAoB,CAAC;AAElH,OAAO,EAAE,mBAAmB,EAAE,MAAM,iCAAiC,CAAC;AAEtE,MAAM,OAAO,yBAA0B,SAAQ,mBAAmB;IAAlE;;QACW,SAAI,GAAG,mDAAmD,CAAC;QAC3D,YAAO,GAAG,OAAO,CAAC;IAuB7B,CAAC;IAnBC,UAAU;QACR,MAAM,EAAE,gBAAgB,EAAE,wBAAwB,EAAE,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC;QACjF,MAAM,CAAC,gBAAgB,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC;QACzD,MAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,EAAiB,EAAE,EAAE;YACvD,IAAI,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC;gBACpC,gBAAgB,CAAC,EAAE,CAAC,CAAC;YACvB,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,cAAc,GAAG,qBAAqB,CAAC,SAAS,CAAC,CAAC,EAAE,IAAI,EAAE,UAAU,EAAE,EAAE,EAAE;YAC7E,IAAI,IAAI,KAAK,mBAAmB,EAAE,CAAC;gBACjC,wBAAwB,CAAC,UAAU,CAAC,CAAC;YACvC,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,OAAO;;QACL,MAAA,IAAI,CAAC,cAAc,0CAAE,WAAW,EAAE,CAAC;IACrC,CAAC;CACF","sourcesContent":["import { BaseInstrumentation, faro, type Subscription, userActionsMessageBus, VERSION } from '@grafana/faro-core';\n\nimport { getUserEventHandler } from './processUserActionEventHandler';\n\nexport class UserActionInstrumentation extends BaseInstrumentation {\n  readonly name = '@grafana/faro-web-sdk:instrumentation-user-action';\n  readonly version = VERSION;\n\n  private _userActionSub?: Subscription;\n\n  initialize(): void {\n    const { processUserEvent, processUserActionStarted } = getUserEventHandler(faro);\n    window.addEventListener('pointerdown', processUserEvent);\n    window.addEventListener('keydown', (ev: KeyboardEvent) => {\n      if ([' ', 'Enter'].includes(ev.key)) {\n        processUserEvent(ev);\n      }\n    });\n\n    this._userActionSub = userActionsMessageBus.subscribe(({ type, userAction }) => {\n      if (type === 'user_action_start') {\n        processUserActionStarted(userAction);\n      }\n    });\n  }\n\n  destroy() {\n    this._userActionSub?.unsubscribe();\n  }\n}\n"]}